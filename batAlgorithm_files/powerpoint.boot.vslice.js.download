"use strict";var __extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),ErrorCategory;(function(n){n[n.Fatal=0]="Fatal";n[n.FatalDocument=1]="FatalDocument";n[n.FatalContent=2]="FatalContent";n[n.Informational=3]="Informational";n[n.ActionRequested=4]="ActionRequested"})(ErrorCategory||(ErrorCategory={}));var PowerPointWebViewerEventHandlerList=function(){function n(){this.m_list=[]}return n.prototype.Add=function(n){for(var t=0;t<this.m_list.length;t++)if(this.m_list[t]==n)return;this.m_list.push(n)},n.prototype.Remove=function(n){for(var t=0;t<this.m_list.length;++t)if(this.m_list[t]==n){this.m_list.splice(t,1);return}},n.prototype.Get=function(n){return n<this.m_list.length?this.m_list[n]:null},n.prototype.Clear=function(){this.m_list.length=0},n.prototype.Length=function(){return this.m_list.length},n}(),PreviewSessionManagerV0=function(){function n(n,t,i,r,u,f,e,o){this.m_automationDiv=null;this.m_anchor=n;this.m_iframe=t;this.m_id=i;this.m_bootedCached=r;this.m_appVersion=u;this.m_percievedBootTime=f;this.m_disposeCallback=e;this.m_logger=o;this.m_eventHandlers=new PowerPointWebViewerEventHandlerList}return n.prototype.dispose=function(){this.Dispose()},n.prototype.Dispose=function(){this.ExitSlideshow();this.m_logger.ULS.traceTag(39203540,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::Dispose - removing anchor:"+(this.m_anchor!=null).toString());this.m_automationDiv=null;this.m_iframe!=null&&(this.m_iframe.src="");this.m_anchor!=null&&this.m_anchor.parentNode!=null&&this.m_anchor.parentNode.removeChild(this.m_anchor);this.m_anchor=null;this.m_iframe=null;this.m_eventHandlers.Clear();this.m_disposeCallback(this.m_id)},n.prototype.GetApplicationType=function(){return"PowerPoint"},n.prototype.GetVersion=function(){return this.m_appVersion},n.prototype.GetSessionId=function(){return this.m_id},n.prototype.GetPercievedBoot=function(){return this.m_percievedBootTime||null},n.prototype.UsingCached=function(){return this.m_bootedCached},n.prototype.GetIsDisabled=function(){return!1},n.prototype.Log=function(n){this.m_logger.ULS.traceTag(39978267,logCategory.PptSession,logLevel.Info,n)},n.prototype.OnMessage=function(t,i){var h,w,e,c,f,l,a,nt,tt,u,r,v,it,b,k,s,rt,y,d,p,g,o;if(this.m_iframe&&this.m_iframe.contentWindow==i){t=t;switch(t.m_type){case WebViewerMessageType.GetSlidesInShowCount:h=t;!isNaN(h.m_slidesCount)&&h.m_slidesCount>=0&&this.TriggerEvent(new GetSlidesInShowCountParams(h.m_slidesCount));break;case WebViewerMessageType.GetTimeLineInfos:w=t;w.m_timeLineInfos!=null&&this.TriggerEvent(new GetTimeLineInfosParams(w.m_timeLineInfos));break;case WebViewerMessageType.GetCurrentPosition:e=t;!isNaN(e.m_slideIndex)&&e.m_slideIndex>=0&&!isNaN(e.m_slideId)&&e.m_slideId>=0&&e.m_timeLineMappings!=null&&this.TriggerEvent(new GetCurrentPositionParams(e.m_slideIndex,e.m_slideId,e.m_timeLineMappings));break;case WebViewerMessageType.GetId:c=t;!isNaN(c.m_slideId)&&c.m_slideId>=0&&this.TriggerEvent(new GetIdParams(c.m_slideId));break;case WebViewerMessageType.OnPositionChanged:f=t;!isNaN(f.m_slideIndex)&&f.m_slideIndex>=0&&!isNaN(f.m_slideId)&&f.m_slideId>=0&&f.m_timeLineMappings!=null&&this.TriggerEvent(new OnPositionChangedParams(f.m_slideIndex,f.m_slideId,f.m_timeLineMappings,f.m_metadata));break;case WebViewerMessageType.MediaEvent:l=t;this.TriggerEvent(new OnMediaEventParams(l.m_mediaPlayerName,l.m_mediaEventType,l.m_mediaPosition));break;case WebViewerMessageType.GetCurrentMediaStates:a=t;this.TriggerEvent(new GetCurrentMediaStatesParams(a.m_slideIndex,a.m_slideId,a.m_mediaStates));break;case WebViewerMessageType.GetPresentationPlaybackState:nt=t;this.TriggerEvent(new GetPresentationPlaybackStateParams(nt.m_playbackState));break;case WebViewerMessageType.OnPresentationPlaybackStateChanged:tt=t;this.TriggerEvent(new OnPresentationPlaybackStateChangedParams(tt.m_playbackState));break;case WebViewerMessageType.GetCurrentSlideDimensions:u=t;!isNaN(u.m_slideWidth)&&u.m_slideWidth>=0&&!isNaN(u.m_slideHeight)&&u.m_slideHeight>=0&&(!isNaN(u.m_slideLeftBound)&&u.m_slideLeftBound>=0&&!isNaN(u.m_slideBottomBound)&&u.m_slideBottomBound>=0?this.TriggerEvent(new GetCurrentSlideDimensionsParams(u.m_slideWidth,u.m_slideHeight,u.m_slideLeftBound,u.m_slideBottomBound)):this.TriggerEvent(new GetCurrentSlideDimensionsParams(u.m_slideWidth,u.m_slideHeight,-1,-1)));break;case WebViewerMessageType.OnError:r=t;!isNaN(r.m_code)&&r.m_code>=0&&(r.m_message=r.m_message?r.m_message:"",v=ErrorCategory.Fatal,it=r.m_code+"_"+v+"_"+r.m_message+"_"+r.m_extraInfo+"_"+r.m_correlationId,this.AddAutomationData("OnError",it),this.TriggerEvent(new OnErrorParams(v,r.m_message,r.m_extraInfo,r.m_sessionId,r.m_correlationId)),this.TriggerEvent(new OnApiErrorParams(r.m_code,v,r.m_extraInfo,r.m_sessionId)));break;case WebViewerMessageType.OnSpecialKey:b=t;n.FIsUintValid(b.m_key)&&this.TriggerEvent(new OnSpecialKeyParams(b.m_key));break;case WebViewerMessageType.OnUlsLog:k=t;k.m_logs&&this.TriggerEvent(new OnUlsLogParams(k.m_logs));break;case WebViewerMessageType.OnBrowserEvent:s=t;s.m_event&&this.TriggerEvent(new OnBrowserEventParams(s.m_event,s.m_clientX,s.m_clientY));break;case WebViewerMessageType.OnEnterEndOfSlideshow:this.TriggerEvent(new OnEnterEndOfSlideshowParams);break;case WebViewerMessageType.OnLeaveEndOfSlideshow:this.TriggerEvent(new OnLeaveEndOfSlideshowParams);break;case WebViewerMessageType.OnContentRefreshBegin:rt=t;this.TriggerEvent(new ContentRefreshBeginParams(rt.m_reason));break;case WebViewerMessageType.OnContentRefreshEnd:this.TriggerEvent(new ContentRefreshEndParams);this.GetSlidesInShowCount();break;case WebViewerMessageType.OnExitSlideshow:y=t;this.TriggerEvent(new OnExitSlideshowParams(y.m_slideId,y.m_slideIndex,y.m_isFromEndOfSlideshow));break;case WebViewerMessageType.OnContextMenu:d=t;this.TriggerEvent(new OnContextMenuParams(d.m_clientX,d.m_clientY));break;case WebViewerMessageType.OnUserInactive:this.TriggerEvent(new OnUserInactiveParams);break;case WebViewerMessageType.OnPodSessionExpired:p=t;this.TriggerEvent(new OnPodSessionExpiredParams(p.m_code,p.m_reason,p.m_podSessionId));break;case WebViewerMessageType.OnRenderedToBuffer:g=t;this.TriggerEvent(new OnRenderedToBufferParams(g.m_slideIndex,g.m_img));break;case WebViewerMessageType.RecordQosError:o=t;this.TriggerEvent(new RecordQosErrorParams(o.m_errorName,o.m_vetoName,o.m_isIntentional,o.m_isInternal,o.m_alertOnPillar,o.m_isSessionEndingError,o.m_durationMs))}}},n.ValidateTimeLineMappings=function(t){var i=!Array.isArray(t),r;if(!i)for(r in t)if(t[r].TimeLineId==null||!n.FIsUintValid(t[r].Step)){i=!0;break}if(i)throw Error("ValidateTimeLineMappings");return t},n.prototype.AddAutomationData=function(n,t){this.EnsureAutomationDiv();var i=document.createElement("p");i.innerText=n+":"+t;this.m_automationDiv.appendChild(i)},n.FIsUintValid=function(n){return!(n==null||n<0||isNaN(n))},n.prototype.EnsureAutomationDiv=function(){this.m_automationDiv||(this.m_automationDiv=document.createElement("div"),this.m_automationDiv.id="pptAutomation-"+this.m_id,this.m_automationDiv.style.visibility="hidden",this.m_anchor.appendChild(this.m_automationDiv))},n.prototype.TriggerEvent=function(n){for(var i,t=0;t<this.m_eventHandlers.Length();++t)i=this.m_eventHandlers.Get(t),i(n)},n.prototype.PostMessageDownward=function(n){if(!this.m_iframe){this.m_logger.ULS.traceTag(39203541,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageDownward iframe is null");return}var t=JSON.stringify(n),i=window.location.search.indexOf("wdForceModernSlideShowInTeams")>=0||this.m_iframe.name.indexOf("slideshowframe")>=0;(this.m_iframe.src.length!=0||i)&&this.m_iframe.contentWindow!=null?this.m_iframe.contentWindow.postMessage(t,this.m_iframe.src==""?"*":this.m_iframe.src):this.m_logger.ULS.traceTag(39203542,logCategory.PptSession,logLevel.Info,"PreviewSessionManagerV0::PostMessageDownward iframe src or contentWindow is empty")},n.prototype.GetSlidesInShowCount=function(){var n=new GetSlidesInShowCountWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetTimeLineInfos=function(t){if(n.FIsUintValid(t)){var i=new GetTimeLineInfosWebViewerInternalMessage(t);this.PostMessageDownward(i)}},n.prototype.GetCurrentPosition=function(){var n=new GetCurrentPositionWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetCurrentPositionWithTimeLines=function(){var n=new GetCurrentPositionWithTimeLinesWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetCurrentSlideDimensions=function(){var n=new GetCurrentSlideDimensionsWebViewerInternalMessage;this.PostMessageDownward(n)},n.prototype.GetId=function(t){n.FIsUintValid(t)&&this.PostMessageDownward(new GetIdWebViewerInternalMessage(t))},n.prototype.Next=function(n){this.PostMessageDownward(new NextWebViewerInternalMessage(n))},n.prototype.PausePresentation=function(){this.PostMessageDownward(new PausePresentationWebViewerInternalMessage)},n.prototype.PlayPresentation=function(){this.PostMessageDownward(new PlayPresentationWebViewerInternalMessage)},n.prototype.GetPresentationPlaybackState=function(){this.PostMessageDownward(new GetPresentationPlaybackStateInternalMessage)},n.prototype.NextSlide=function(){this.PostMessageDownward(new NextSlideWebViewerInternalMessage)},n.prototype.Prev=function(n){this.PostMessageDownward(new PrevWebViewerInternalMessage(n))},n.prototype.PrevSlide=function(){this.PostMessageDownward(new PrevSlideWebViewerInternalMessage)},n.prototype.GoToNextSlide=function(){this.PostMessageDownward(new GoToNextSlideWebViewerInternalMessage)},n.prototype.GoToPrevSlide=function(){this.PostMessageDownward(new GoToPrevSlideWebViewerInternalMessage)},n.prototype.GoToSlide=function(t,i,r){n.FIsUintValid(t)&&n.ValidateTimeLineMappings(i)&&this.PostMessageDownward(new GoToSlideWebViewerInternalMessage(t,i,r))},n.prototype.GoToSlideId=function(t,i){n.FIsUintValid(t)&&n.ValidateTimeLineMappings(i)&&this.PostMessageDownward(new GoToSlideIdWebViewerInternalMessage(t,i))},n.prototype.SwitchRole=function(n){this.PostMessageDownward(new SwitchRoleWebViewerInternalMessage(n))},n.prototype.PlayMedia=function(n){this.PostMessageDownward(new PlayMediaInternalMessage(n))},n.prototype.PauseMedia=function(n){this.PostMessageDownward(new PauseMediaInternalMessage(n))},n.prototype.RestoreFocus=function(){this.PostMessageDownward(new RestoreFocusInternalMessage)},n.prototype.StopMedia=function(n){this.PostMessageDownward(new StopMediaInternalMessage(n))},n.prototype.SeekMedia=function(n,t){this.PostMessageDownward(new SeekMediaInternalMessage(n,t))},n.prototype.GetCurrentMediaStates=function(){this.PostMessageDownward(new GetCurrentMediaStatesInternalMessage)},n.prototype.ExitSlideshow=function(){this.PostMessageDownward(new ExitSlideshowInternalMessage)},n.prototype.RefreshPodSession=function(n,t){this.PostMessageDownward(new RefreshPodSessionInternalMessage(n,t))},n.prototype.SetNavigationOptions=function(n,t){this.PostMessageDownward(new SetNavigationOptionsMessage(n,t))},n.prototype.ShowHideCursor=function(n){this.PostMessageDownward(new ShowHideCursorWebViewerInternalMessage(n))},n.prototype.PostMessageToInkManager=function(n,t){this.PostMessageDownward(new InkManagerInternalMessage(n,t))},n.prototype.SendSessionMetadata=function(n,t){try{n!=null&&t!=null?this.m_logger.ULS.traceTag(588804101,logCategory.PptSession,logLevel.Info,n+": "+JSON.stringify(t)):this.m_logger.ULS.traceTag(588804100,logCategory.PptSession,logLevel.Warning,"SendSessionMetadata called with null params")}catch(i){this.m_logger.ULS.traceTag(588804099,logCategory.PptSession,logLevel.Error,"SendSessionMetadata error: "+JSON.stringify(i))}},n.prototype.OnSliceLoaded=function(){},n.prototype.AddEventHandler=function(n){n&&this.m_eventHandlers.Add(n)},n.prototype.RegisterEventHandler=function(n,t){var i=this;t||(t=n,n="*");n=="*"&&this.m_eventHandlers.Add(function(n){i.filterEventOrErrorHandler(n,!1,t)});n=="ContentRefreshBegin"&&this.m_eventHandlers.Add(function(n){n.EventType==21&&t(n)});n=="ContentRefreshEnd"&&this.m_eventHandlers.Add(function(n){n.EventType==22&&t(n)})},n.prototype.RegisterErrorHandler=function(n){var t=this;n&&this.m_eventHandlers.Add(function(i){t.filterEventOrErrorHandler(i,!0,n)})},n.prototype.RemoveEventHandler=function(n,t){var i=this;t||(t=n,n="*");n=="*"&&this.m_eventHandlers.Remove(function(n){i.filterEventOrErrorHandler(n,!1,t)});n=="ContentRefreshBegin"&&this.m_eventHandlers.Remove(function(n){n.EventType==21&&t(n)});n=="ContentRefreshEnd"&&this.m_eventHandlers.Remove(function(n){n.EventType==22&&t(n)});n||this.m_eventHandlers.Remove(t)},n.prototype.RemoveErrorHandler=function(n){var t=this;n&&this.m_eventHandlers.Remove(function(i){t.filterEventOrErrorHandler(i,!0,n)})},n.prototype.filterEventOrErrorHandler=function(n,t,i){if(n.EventType==13&&t){var r=n;i(r)}n.EventType==13||t||i(n)},n}(),PreviewAPIV0Factory=function(){function n(){}return n.prototype.GetPreviewAPIV1=function(n,t,i,r,u,f,e,o){return new PreviewSessionManagerV0(n,t,i,r,u,f,e,o)},n}();Microsoft.Office.PowerPoint.Bootstrap&&Microsoft.Office.PowerPoint.Bootstrap.SetPreviewAPIFactory(new PreviewAPIV0Factory);var ViewerEventParams=function(){function n(n){this.EventType=n}return n}(),ViewerEventType=function(){function n(){}return n.GetSlidesInShowCount=0,n.GetTimeLineInfos=1,n.GetCurrentPosition=2,n.GetId=3,n.GetPresentationName=4,n.OnPositionChanged=5,n.OnPresentationOpened=6,n.GetCurrentSlideDimensions=7,n.OnMediaEvent=9,n.GetCurrentMediaStates=10,n.OnError=11,n.OnSpecialKey=12,n.OnApiError=13,n.OnUlsLog=14,n.GetCurrentPlayModeState_Unused=15,n.GetPresentationPlaybackState=16,n.OnPresentationPlaybackStateChanged=17,n.OnBrowserEvent=18,n.OnEnterEndOfSlideshow=19,n.OnLeaveEndOfSlideshow=20,n.ContentRefreshBegin=21,n.ContentRefreshEnd=22,n.OnExitSlideshow=23,n.OnContextMenu=24,n.OnUserInactive=25,n.OnPodSessionExpired=27,n.OnRenderedToBuffer=28,n.RecordQosError=33,n}(),OnApiErrorParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.OnApiError)||this;return f.Code=t,f.Category=i,f.ExtraInfo=r,f.SessionId=u,f.errorType=f.EventType.toString(),f.errorObject=null,f}return __extends(t,n),t}(ViewerEventParams),GetSlidesInShowCountParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetSlidesInShowCount)||this;return i.SlidesCount=t,i}return __extends(t,n),t}(ViewerEventParams),GetTimeLineInfosParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetTimeLineInfos)||this;return i.TimeLineInfos=t,i}return __extends(t,n),t}(ViewerEventParams),GetCurrentPositionParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.GetCurrentPosition)||this;return u.SlideIndex=t,u.SlideId=i,u.TimeLineMappings=r,u}return __extends(t,n),t}(ViewerEventParams),GetCurrentSlideDimensionsParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.GetCurrentSlideDimensions)||this;return f.SlideWidth=t,f.SlideHeight=i,f.SlideLeftBound=r,f.SlideBottomBound=u,f}return __extends(t,n),t}(ViewerEventParams),GetIdParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetId)||this;return i.SlideId=t,i}return __extends(t,n),t}(ViewerEventParams),OnPositionChangedParams=function(n){function t(t,i,r,u){var f=n.call(this,ViewerEventType.OnPositionChanged)||this;return f.SlideIndex=t,f.SlideId=i,f.TimeLineMappings=r,f.Metadata=u,f}return __extends(t,n),t}(ViewerEventParams),OnPresentationPlaybackStateChangedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnPresentationPlaybackStateChanged)||this;return i.PlaybackState=t,i}return __extends(t,n),t}(ViewerEventParams),OnMediaEventParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnMediaEvent)||this;return u.MediaPlayerName=t,u.MediaEventType=i,u.MediaPosition=r,u}return __extends(t,n),t}(ViewerEventParams),GetCurrentMediaStatesParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.GetCurrentMediaStates)||this;return u.SlideIndex=t,u.SlideId=i,u.MediaStates=r,u}return __extends(t,n),t}(ViewerEventParams),GetPresentationPlaybackStateParams=function(n){function t(t){var i=n.call(this,ViewerEventType.GetPresentationPlaybackState)||this;return i.PlaybackState=t,i}return __extends(t,n),t}(ViewerEventParams),OnPresentationOpenedParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnPresentationOpened)||this;return i.SessionId=t,i}return __extends(t,n),t}(ViewerEventParams),OnErrorParams=function(n){function t(t,i,r,u,f){var e=n.call(this,ViewerEventType.OnError)||this;return e.Category=t,e.Message=i,e.ExtraInfo=r,e.SessionId=u,e.CorrelationId=f,e}return __extends(t,n),t}(ViewerEventParams),OnSpecialKeyParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnSpecialKey)||this;return i.Key=t,i}return __extends(t,n),t}(ViewerEventParams),OnUlsLogParams=function(n){function t(t){var i=n.call(this,ViewerEventType.OnUlsLog)||this;return i.Logs=t,i}return __extends(t,n),t}(ViewerEventParams),OnBrowserEventParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnBrowserEvent)||this;return u.BrowserEvent=t,u.ClientX=i,u.ClientY=r,u}return __extends(t,n),t}(ViewerEventParams),OnEnterEndOfSlideshowParams=function(n){function t(){return n.call(this,ViewerEventType.OnEnterEndOfSlideshow)||this}return __extends(t,n),t}(ViewerEventParams),OnLeaveEndOfSlideshowParams=function(n){function t(){return n.call(this,ViewerEventType.OnLeaveEndOfSlideshow)||this}return __extends(t,n),t}(ViewerEventParams),ContentRefreshBeginParams=function(n){function t(t){var i=n.call(this,ViewerEventType.ContentRefreshBegin)||this;return i.reason=t,i}return __extends(t,n),t}(ViewerEventParams),ContentRefreshEndParams=function(n){function t(){var t=n.call(this,ViewerEventType.ContentRefreshEnd)||this;return t.succeeded=!0,t}return __extends(t,n),t}(ViewerEventParams),OnExitSlideshowParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnExitSlideshow)||this;return u.SlideId=t,u.SlideIndex=i,u.IsFromEndOfSlideshow=r,u}return __extends(t,n),t}(ViewerEventParams),OnContextMenuParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.OnContextMenu)||this;return r.ClientX=t,r.ClientY=i,r}return __extends(t,n),t}(ViewerEventParams),OnUserInactiveParams=function(n){function t(){return n.call(this,ViewerEventType.OnUserInactive)||this}return __extends(t,n),t}(ViewerEventParams),OnPodSessionExpiredParams=function(n){function t(t,i,r){var u=n.call(this,ViewerEventType.OnPodSessionExpired)||this;return u.Code=t,u.Reason=i,u.PodSessionId=r,u}return __extends(t,n),t}(ViewerEventParams),OnRenderedToBufferParams=function(n){function t(t,i){var r=n.call(this,ViewerEventType.OnRenderedToBuffer)||this;return r.SlideIndex=t,r.Img=i,r}return __extends(t,n),t}(ViewerEventParams),RecordQosErrorParams=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,ViewerEventType.RecordQosError)||this;return s.ErrorName=t,s.VetoName=i,s.IsIntentional=r,s.IsInternal=u,s.AlertOnPillar=f,s.IsSessionEndingError=e,s.DurationMs=o,s}return __extends(t,n),t}(ViewerEventParams),WebViewerMessageType;(function(n){n[n.Handshake=0]="Handshake";n[n.GetSlidesInShowCount=1]="GetSlidesInShowCount";n[n.GetTimeLineInfos=2]="GetTimeLineInfos";n[n.GetCurrentPosition=3]="GetCurrentPosition";n[n.GetId=4]="GetId";n[n.OnPositionChanged=5]="OnPositionChanged";n[n.OpenPresentation=6]="OpenPresentation";n[n.GetCurrentSlideDimensions=7]="GetCurrentSlideDimensions";n[n.MediaEvent=8]="MediaEvent";n[n.GetCurrentMediaStates=9]="GetCurrentMediaStates";n[n.OnError=10]="OnError";n[n.OnSpecialKey=11]="OnSpecialKey";n[n.OnRefresh=12]="OnRefresh";n[n.RejectedMessage=13]="RejectedMessage";n[n.OnUlsLog=14]="OnUlsLog";n[n.GetCurrentPlayModeState_Unused=15]="GetCurrentPlayModeState_Unused";n[n.GetPresentationPlaybackState=16]="GetPresentationPlaybackState";n[n.OnPresentationPlaybackStateChanged=17]="OnPresentationPlaybackStateChanged";n[n.OnBrowserEvent=18]="OnBrowserEvent";n[n.OnEnterEndOfSlideshow=19]="OnEnterEndOfSlideshow";n[n.OnLeaveEndOfSlideshow=20]="OnLeaveEndOfSlideshow";n[n.OnContentRefreshBegin=21]="OnContentRefreshBegin";n[n.OnContentRefreshEnd=22]="OnContentRefreshEnd";n[n.OnExitSlideshow=23]="OnExitSlideshow";n[n.OnContextMenu=24]="OnContextMenu";n[n.OnUserInactive=25]="OnUserInactive";n[n.OnPodSessionExpired=27]="OnPodSessionExpired";n[n.AppReadyForPostMessage=28]="AppReadyForPostMessage";n[n.OnRenderedToBuffer=29]="OnRenderedToBuffer";n[n.RecordQosError=33]="RecordQosError";n[n.SwitchRole=34]="SwitchRole";n[n.LogToBootstrapper=40]="LogToBootstrapper";n[n.PostFailureUpwards=41]="PostFailureUpwards"})(WebViewerMessageType||(WebViewerMessageType={}));var HandshakeWebViewerMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.Handshake)||this;return u.m_sessionId=i,u.m_percievedBootTime=r,u}return __extends(t,n),t}(WebViewerBaseMessage),GetSlidesInShowCountWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetSlidesInShowCount)||this;return r.m_slidesCount=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetTimeLineInfosWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetTimeLineInfos)||this;return r.m_timeLineInfos=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentPositionWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.GetCurrentPosition)||this;return f.m_slideIndex=i,f.m_slideId=r,f.m_timeLineMappings=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentSlideDimensionsWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.GetCurrentSlideDimensions)||this;return e.m_slideWidth=i,e.m_slideHeight=r,e.m_slideLeftBound=u,e.m_slideBottomBound=f,e}return __extends(t,n),t}(WebViewerBaseMessage),GetIdWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.Handshake)||this;return r.m_slideId=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnPositionChangedWebViewerMessage=function(n){function t(t,i,r,u,f){var e=n.call(this,t,WebViewerMessageType.OnPositionChanged)||this;return e.m_slideIndex=i,e.m_slideId=r,e.m_timeLineMappings=u,e.m_metadata=f?f:{},e}return __extends(t,n),t}(WebViewerBaseMessage),MediaEventWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.MediaEvent)||this;return f.m_mediaPlayerName=i,f.m_mediaEventType=r,f.m_mediaPosition=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnErrorWebViewerMessage=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,WebViewerMessageType.OnError)||this;return o.m_code=i,o.m_message=r,o.m_extraInfo=u,o.m_sessionId=f,o.m_correlationId=e,o}return __extends(t,n),t}(WebViewerBaseMessage),OnSpecialKeyWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnSpecialKey)||this;return r.m_key=i,r}return __extends(t,n),t}(WebViewerBaseMessage),GetCurrentMediaStatesWebViewerMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.GetCurrentMediaStates)||this;return f.m_slideIndex=i,f.m_slideId=r,f.m_mediaStates=u,f}return __extends(t,n),t}(WebViewerBaseMessage),GetPresentationPlaybackStateWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.GetPresentationPlaybackState)||this;return r.m_playbackState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnPresentationPlaybackStateChangedWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnPresentationPlaybackStateChanged)||this;return r.m_playbackState=i,r}return __extends(t,n),t}(WebViewerBaseMessage),RejectedMessageWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.RejectedMessage)||this;return r.m_data=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnUlsLogWebViewerMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnUlsLog)||this;return r.m_logs=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnBrowserEventMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnBrowserEvent)||this;return f.m_event=i,f.m_clientX=r,f.m_clientY=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnContentRefreshBeginMessage=function(n){function t(t,i){var r=n.call(this,t,WebViewerMessageType.OnContentRefreshBegin)||this;return r.m_reason=i,r}return __extends(t,n),t}(WebViewerBaseMessage),OnExitSlideshowMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnExitSlideshow)||this;return f.m_slideId=i,f.m_slideIndex=r,f.m_isFromEndOfSlideshow=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnContextMenuMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnContextMenu)||this;return u.m_clientX=i,u.m_clientY=r,u}return __extends(t,n),t}(WebViewerBaseMessage),OnPodSessionExpiredMessage=function(n){function t(t,i,r,u){var f=n.call(this,t,WebViewerMessageType.OnPodSessionExpired)||this;return f.m_code=i,f.m_reason=r,f.m_podSessionId=u,f}return __extends(t,n),t}(WebViewerBaseMessage),OnRenderedToBufferMessage=function(n){function t(t,i,r){var u=n.call(this,t,WebViewerMessageType.OnRenderedToBuffer)||this;return u.m_slideIndex=i,u.m_img=r,u}return __extends(t,n),t}(WebViewerBaseMessage),RecordQosErrorMessage=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,WebViewerMessageType.RecordQosError)||this;return h.m_errorName=i,h.m_vetoName=r,h.m_isIntentional=u,h.m_isInternal=f,h.m_alertOnPillar=e,h.m_isSessionEndingError=o,h.m_durationMs=s,h}return __extends(t,n),t}(WebViewerBaseMessage),WebViewerInternalMessageType;(function(n){n[n.Handshake=0]="Handshake";n[n.GetSlidesInShowCount=1]="GetSlidesInShowCount";n[n.GetTimeLineInfos=2]="GetTimeLineInfos";n[n.GetCurrentPosition=3]="GetCurrentPosition";n[n.GetId=4]="GetId";n[n.Next=5]="Next";n[n.NextSlide=6]="NextSlide";n[n.Prev=7]="Prev";n[n.PrevSlide=8]="PrevSlide";n[n.GoToSlide=9]="GoToSlide";n[n.GoToSlideId=10]="GoToSlideId";n[n.Popout=11]="Popout";n[n.GetCurrentSlideDimensions=12]="GetCurrentSlideDimensions";n[n.DisplayBlackSlide=13]="DisplayBlackSlide";n[n.DisplayWhiteSlide=14]="DisplayWhiteSlide";n[n.PlayMedia=15]="PlayMedia";n[n.PauseMedia=16]="PauseMedia";n[n.StopMedia=17]="StopMedia";n[n.SeekMedia=18]="SeekMedia";n[n.GetCurrentMediaStates=19]="GetCurrentMediaStates";n[n.PausePresentation=20]="PausePresentation";n[n.PlayPresentation=21]="PlayPresentation";n[n.GetCurrentPlayModeState_Unused=22]="GetCurrentPlayModeState_Unused";n[n.GetPresentationPlaybackState=23]="GetPresentationPlaybackState";n[n.GoToNextSlide=24]="GoToNextSlide";n[n.GoToPrevSlide=25]="GoToPrevSlide";n[n.BootTimingFromApi=26]="BootTimingFromApi";n[n.GenericULSLog=27]="GenericULSLog";n[n.RestoreFocus=28]="RestoreFocus";n[n.ExitSlideshow=29]="ExitSlideshow";n[n.RefreshPodSession=30]="RefreshPodSession";n[n.SetNavigationOptions=31]="SetNavigationOptions";n[n.ShowHideCursor=32]="ShowHideCursor";n[n.RecordStartedSlideShowTimestamp=33]="RecordStartedSlideShowTimestamp";n[n.GetCurrentPositionWithTimeLines=34]="GetCurrentPositionWithTimeLines";n[n.InkManager=35]="InkManager";n[n.SwitchRole=34]="SwitchRole"})(WebViewerInternalMessageType||(WebViewerInternalMessageType={}));var GetCurrentSlideDimensionsWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentSlideDimensions)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetSlidesInShowCountWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetSlidesInShowCount)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetTimeLineInfosWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.GetTimeLineInfos)||this;return i.m_slideIndex=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentPositionWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentPosition)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentPositionWithTimeLinesWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentPositionWithTimeLines)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetIdWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.GetId)||this;return i.m_slideIndex=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),NextWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.Next)||this;return i.m_metadata=t?t:{},i}return __extends(t,n),t}(WebViewerBaseInternalMessage),NextSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.NextSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToNextSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GoToNextSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToPrevSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GoToPrevSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PausePresentationWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PausePresentation)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PlayPresentationWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PlayPresentation)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetPresentationPlaybackStateInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetPresentationPlaybackState)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PrevWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.Prev)||this;return i.m_metadata=t?t:{},i}return __extends(t,n),t}(WebViewerBaseInternalMessage),DisplayBlackSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.DisplayBlackSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),DisplayWhiteSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.DisplayWhiteSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PrevSlideWebViewerInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.PrevSlide)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToSlideWebViewerInternalMessage=function(n){function t(t,i,r){var u=n.call(this,WebViewerInternalMessageType.GoToSlide)||this;return u.m_slideIndex=t,u.m_timeLineMappings=i,u.m_metadata=r?r:{},u}return __extends(t,n),t}(WebViewerBaseInternalMessage),GoToSlideIdWebViewerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.GoToSlideId)||this;return r.m_slideId=t,r.m_timeLineMappings=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),PopoutInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.Popout)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),PlayMediaInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.PlayMedia)||this;return i.m_mediaPlayerName=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),PauseMediaInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.PauseMedia)||this;return i.m_mediaPlayerName=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),RestoreFocusInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.RestoreFocus)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),StopMediaInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.StopMedia)||this;return i.m_mediaPlayerName=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),SeekMediaInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.SeekMedia)||this;return r.m_mediaPlayerName=t,r.m_position=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),GetCurrentMediaStatesInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.GetCurrentMediaStates)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),GenericULSLogInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.GenericULSLog)||this;return r.m_tagID=t,r.m_message=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),ExitSlideshowInternalMessage=function(n){function t(){return n.call(this,WebViewerInternalMessageType.ExitSlideshow)||this}return __extends(t,n),t}(WebViewerBaseInternalMessage),RefreshPodSessionInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.RefreshPodSession)||this;return r.m_podSessionId=t,r.m_wacCluster=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SetNavigationOptionsMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.SetNavigationOptions)||this;return r.m_enableAdvanceOnClick=t,r.m_enableKeyboardNavigation=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),ShowHideCursorWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.ShowHideCursor)||this;return i.m_fShow=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage),InkManagerInternalMessage=function(n){function t(t,i){var r=n.call(this,WebViewerInternalMessageType.InkManager)||this;return r.m_item=t,r.m_color=i,r}return __extends(t,n),t}(WebViewerBaseInternalMessage),SwitchRoleWebViewerInternalMessage=function(n){function t(t){var i=n.call(this,WebViewerInternalMessageType.SwitchRole)||this;return i.m_role=t,i}return __extends(t,n),t}(WebViewerBaseInternalMessage);